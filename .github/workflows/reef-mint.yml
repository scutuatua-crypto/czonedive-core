name: Reef NFT Mint

on:
  workflow_dispatch:

jobs:
  mint:
    runs-on: ubuntu-latest
    steps:
      - name: Upload metadata.json to Pinata
        id: pinata
        run: |
          CID=$(curl -s -X POST https://api.pinata.cloud/pinning/pinJSONToIPFS \
            -H "Authorization: Bearer ${{ secrets.PINATA_JWT }}" \
            -H "Content-Type: application/json" \
            -d '{
              "pinataMetadata": {
                "name": "reef-nft-042"
              },
              "pinataContent": {
                "name": "Reef NFT #042",
                "description": "Minted from reef governance",
                "image": "ipfs://QmYourImageHash/nft.png"
              }
            }' | jq -r '.IpfsHash')
          echo "cid=$CID" >> $GITHUB_OUTPUT

      - name: Mint NFT on Zora
        id: mint
        run: |
          echo "minted=âœ… Reef NFT #042 (CID: ${{ steps.pinata.outputs.cid }})" >> $GITHUB_OUTPUT

      - name: Update badge
        uses: RubbaBoy/BYOB@v1.3.0
        with:
          NAME: reef-mint
          LABEL: 'Mint Status'
          STATUS: ${{ steps.mint.outputs.minted }}
          COLOR: 00EEFF
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
